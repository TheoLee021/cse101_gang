# Assignment 4

Contributors:
- Andrew Le, [aal034@ucsd.edu](mailto:aal034@ucsd.edu)
- Theo Lee, [thl030@ucsd.edu](mailto:thl030@ucsd.edu)
- Yezhi Wu, [yew020@ucsd.edu](mailto:yew020@ucsd.edu)

Due: Feb 12 2026

---
## Question 1

---
## Question 2
Suppose you have an energy network given by a connected undirected graph $G$ with $n$ vertices and $m$ edges with positive edge weights (that represent the maintenance cost of each edge.) You are allowed to build $k$ power-plants each at a different vertex of the graph.

Design an algorithm that return the locations of the power-plants and the edges of the minimum weight sub-forest of $k$ trees such that each tree has one power-plants and every vertex is part of a tree.

**High level algorithm:**
Since given a connected undirected graph $G$ with $n,m \in G$. After running *kruskal's* algorithm $Kruskal(G)$ for $G$, we will get a subset of edges $T \subseteq E$ Minimum Spanning Tree $T$. Then, to sort all the edges $e \in T$ in descending order. After the sort algorithm, we cut/remove $k-1$ heaviest edges $e$ from $T$. Now, we got a minimum weight sub-forest of $k$ tree. Then, we chose the any of one vertex from the minimum weight sub-forest (location on each tress doesn't matter) as $k$ power-plants, and put it in $L$ location set. Finally, return the set $L$ and all edges $e\in T$.

**Correctness:**

First, let establish that the optimal answer must be a spanning forest consisting of exactly $k$ tree such that each for each $k$ tree from this forest. If any edge $e$ in the tree is cut, it will produce another isolate tree that disconnecting with other. It remind $k+1$ tree in this forest.

Exchange Argument: Let $g$ be the heaviest edge as the first greedy decision in $T$. Let $AS\subseteq T$ be an arbitrary solution that does **NOT** contain $g$. Then the solution $AS'\subseteq T$ that contains $g$ and $AS'$ is at least as good as $AS$.

To prove that $AS'$ has valid structure since running *kruskal's* algorithm for $G$, it will produces a subset $T$ Minimum Spanning Tree. Therefore, $G(V,T)$ is a sub-forest, and any tree for this sub-forest has no path to each other, then it satisfies the structure of result. Then, after cutting any $k-1$ edges from $T$, it still remains a sub-forest of $G$ by the *Cut property*. In conclusion, $AS'$ is a valid structure and the value of $|AS'| \ge |AS|$.

Base case: Assume the instance size $n = 1$, the greedy choice $g \in T$ is the only choice to satisfy constraints. Thus, $GS$ is optimal for $n=1$. 

Inductive Hypothesis: Assume that for all instance of size $k < n$, the greedy algorithm produces an optimal solution.

Inductive Step: Let $g$ be first greed decision for the instance $I$ of size $n$. Let $I'$ be the set that is not contains $g$, and $GS=g \cup S(I')$, where $S(I')$ is some solution of $I$. As know as, $AS$ is any legal solution and $AS'$ is the other case of solution that contains $g$ by the Exchange Augment. Therefore, $AS' = g \cup GS(I')$.

Conclusion: $|AS| \le |AS'| = |g \cup AS(I')|  \le |g \cup S(I')|  = |GS(I)|$, then, $GS$ is optimal for the minimum weight sub-forest of $k$ tree.

**Time Analysis:**
- Running *kruskal's* algorithm for $G$ takes $O((n+m)log(n))$ time.
- Running the sort algorithm for $e\in T$ takes $O(mlog(m))$ time
- Cutting edges from sub-forest takes $O(m)$ time since $k\le m - 1$.
- Adding any power-plants in the forest takes $O(n)$ time since $k \le n$.

Therefore, the time complexity of this algorithm is $O((n+m)log(n))$.

---
## Question 3
(Exactly one of the greedy strategies always generates the optimal solution.)

[2 points for part a, 4 points for counterexample, 8 points for proving the correct algorithm is optimal]

You manage a billboard over the interstate. The billboard can only be changed in the early morning.

You have a list of $n$ billboard ads given as a list of tuples of payment and deadlines $[(p_1,d_1),\dots,(p_n,d_n)]$ such that if you display ad $i$ on or before day $d_i$, then you will be payed the amount $p_i$ (You only get paid once per billboard.)

Suppose that this batch of ads comes to you on day 1 (and each day $1\leq d_i$ is an integer value greater or equal to 1).

You wish to plan out which billboards to display on which days in order to maximize the total payment amount.

Example:

|**Billboard #**|**1**|**2**|**3**|**4**|**5**|**6**|**7**|**8**|**9**|**10**|**11**|
|---|---|---|---|---|---|---|---|---|---|---|---|
|Payment|100|150|500|300|325|50|225|175|200|150|300|
|Deadline|4|7|3|1|3|4|4|4|8|8|4|

Then one way you could schedule is:

|**Billboard #**|**1**|**2**|**3**|**4**|**5**|**6**|**7**|**8**|**9**|**10**|**11**|
|---|---|---|---|---|---|---|---|---|---|---|---|
|Payment|100|150|500|300|325|50|225|175|200|150|300|
|Deadline|4|7|3|1|3|4|4|4|8|8|4|
|Schedule|X|7|3|1|2|X|4|X|8|5|X|

This would yield a total of:

$$150 + 500 + 300 + 325 + 225 + 200 + 150 = 1850$$

(Note that this is not necessarily the best schedule.)

a) Describe this problem as we have done in class in terms of:

- Input: $[(p_1,d_1),\dots,(p_n,d_n)]$, the payments and deadlines for each billboard.
- Solution Format: an assignment of each billboard to a day to display it.
- Constraints: Each billboard is displayed at most once. At most one billboard is displayed per day. If billboard $i$ is displayed on day $j$, then $j \leq d_i$.
- Objective: Maximize the total payment $\sum p_i$ over all displayed billboards.

b) Candidate Greedy Strategy 1:

Sort the billboards by deadlines (earliest to latest. If there is a tie, then put the one with the bigger payment first.)

For each billboard in the list (in order), display it on the earliest day available (if there are no available days before the deadline then go to the next billboard in the list.)

Either prove that this strategy always yields an optimal solution or give a counterexample to show that it is not always optimal.

Solution:

This strategy does not always work. Consider the counter-example:
$[(p_1,d_1),(p_2,d_2),(p_3,d_3)] = [(5,1),(6,2),(7,2)]$.

Then by this strategy, we sort by deadline (ties broken by bigger payment first) and assign each billboard to the earliest available day. Billboard 1 $(p=5, d=1)$ is assigned to Day 1, Billboard 3 $(p=7, d=2)$ is assigned to Day 2, and Billboard 2 $(p=6, d=2)$ has no available day before its deadline, so it is not displayed. The total payment is $5 + 7 = 12$.

A better solution would be to assign Billboard 3 to Day 1 and Billboard 2 to Day 2 for a total payment of $7 + 6 = 13$.


c) Candidate Greedy Strategy II:

Sort the billboards in decreasing order by payment. (If there is a tie, then put the one with the earlier deadline first.

For each billboard in the list (in order), display it on the latest day possible (before or on its deadline.) (if there are no available days before the deadline then go to the next billboard in the list.)

Either prove that this strategy always yields an optimal solution or give a counterexample to show that it is not always optimal.

Solution:


This strategy is optimal.

Exchange Argument Claim: Let $g$ be the billboard with the highest payment (the first greedy choice). Let $OS$ be any valid schedule that does not include $g$. Then there is a valid schedule $OS'$ that includes $g$ and has total payment at least as large as $OS$.

Proof of Exchange Argument: Suppose $OS$ is a valid schedule that does not include $g$. Consider two cases:

Case 1: There is an unoccupied day $j \leq d_g$ in $OS$. Then create $OS'$ by adding $g$ on day $j$. $OS'$ is valid since $j \leq d_g$ and day $j$ was unoccupied. The total payment of $OS'$ is the total payment of $OS$ plus $p_g$, so $OS'$ is better than $OS$.

Case 2: All days $1, \ldots, d_g$ are occupied in $OS$. Let $b$ be the billboard occupying some day $j \leq d_g$ with the smallest payment among them. Create $OS'$ from $OS$ by removing $b$ and assigning $g$ to day $j$. $OS'$ is valid since $j \leq d_g$ and all other assignments are unchanged. Since $g$ has the highest payment among all billboards, $p_g \geq p_b$, so the total payment of $OS'$ is the total payment of $OS$ minus $p_b$ plus $p_g$, which is at least as large as the total payment of $OS$.

Induction Part:

Claim: For any input of any size $n \geq 1$, the greedy solution is optimal.

Base Case: For $n = 1$, the greedy strategy displays the single billboard on its deadline day (or the latest available day), which is the optimal solution.

Inductive Hypothesis: Suppose that for some $n > 1$, the greedy strategy is optimal for all inputs of size $k$ such that $1 \leq k \leq n - 1$.

Inductive Step: Suppose $I$ is an input of size $n$. Let $g$ be the billboard with the highest payment and let $OS$ be any valid schedule for $I$. Then by the Exchange Argument, there exists a schedule $OS'$ that includes $g$ and has total payment at least as large as $OS$. Let $I'$ be the remaining billboards after removing $g$, with the day assigned to $g$ removed from the set of available days. Then $I'$ has $n - 1$ billboards, so by the inductive hypothesis the greedy strategy is optimal on $I'$. Therefore, we have that:

$$OS(I) \leq OS'(I) = p_g + S(I') \leq p_g + GS(I') = GS(I)$$

where $S(I')$ is the total payment of the rest of the schedule in $OS'$ on $I'$, and $GS(I')$ is the greedy solution on $I'$.

---
## Question 4

**Answer:**

a) 

Input: 

- List L $(w_1,...,w_n)$ of n packages and maximum weight capacity W > 0

Solution Format:

- Set S of pairs to represent trips with packages chosen from L. Each element in S can be a package or a pair of packages.

Constraints: 

- Each element in S must have the combined weight $\leq$ W

Objective:

- Minimize the number of trips or elements in S

b)

Counterexample: Let W = 10. L = {4,3,3,7}

After sorting in ascending order, L = {3,3,4,7}

The algorithm pairs (3,3) first because 3 + 3 < 10. The remaining elements are {4,7}.

The algorithm cannot pair 4 and 7 because 4 + 7 > 10. So, it will add 2 elements to S: (4) and (7)

The result will be {(3,3), (4), (7)}. So it takes 3 trips to move the packages.

Better solution: {(3,7), (3,4)}. This only takes 2 trips to move the packages.

Therefore, this algorithm is not always optimal.

c)

Strategy II is always optimal.

Proof:

ExArg claim: After sorting the list, we have L = $(w_1,...,w_n)$. Assume the algorithm picks the lightest package at that momment, $w_i$, and pair with the heaviest package at that momment, $w_j$, such that $w_i + w_j \leq W$. Let OS be any optimal solution that does not pair $(w_i,w_j)$. Then there exists an optimal solution OS' that pairs $(w_i,w_j)$ and has at least as few trips as OS.

Proof of ExArg:

Case 1: $w_i$ is not paired with any other package

If $w_j$ is also not paired with any other package, then pairing $(w_i,w_j)$ reduces the number of trips by 1.

Else if $w_j$ is paired with some package called $w_k$, we have 2 trips. And if we instead pair $(w_i, w_j)$ and $w_k$ stays alone, we still have 2 trips. 

Therefore, in this case, OS' will always have the same or less trips than OS.

Case 2: $w_i$ is paired with another package named $w_a$

If $w_j$ is not paired with any other package, we have 2 trips. And if we instead pair $(w_i, w_j)$ and $w_a$ stays alone, we still have 2 trips. 

Else if $w_j$ is paired with another package named $w_b$, we have 2 trips. Since $w_j$ is the heaviest package that can be paired with $w_i$ and $w_a$ can be paired with $w_i$, $w_j$ is heavier than $w_a$. And since $w_j$ is paired with $w_b$, $w_j + w_b \leq W$. Therefore, $w_a + w_b \leq W$. So $w_a$ and $w_b$ can always be paired together. Therefore, we can pair $w_i$ with $w_j$ and pair $w_a$ with $w_b$. We still have 2 trips. 

Therefore, in this case, OS' will still always have the same or less trips than OS.

Induction Part:

Claim: For any input of any size >= 0, the greedy solution is always optimal.

Base case: For n = 0, it will always take 0 trips.

For n = 1, it will always take 1 trip to move the package.

For n = 2, if the combined weight of both packages is less than or equal to W, the algorithm pairs them so it takes 1 trip. If not, then the algorithm results in 2 trips. This is optimal.

Base case holds.

Induction Hypothesis: Suppose that for some n > 0, the greedy strategy is always optimal. 
---
